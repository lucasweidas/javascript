<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jogo da Velha</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <main>
        <div class="container">
            <div class="jogador-c">
                <p id="jogador">Jogador atual: <span>X</span></p>
            </div>
            <div class="jogo">
                <button class="btn">1</button>
                <button class="btn">2</button>
                <button class="btn">3</button>
                <button class="btn">4</button>
                <button class="btn">5</button>
                <button class="btn">6</button>
                <button class="btn">7</button>
                <button class="btn">8</button>
                <button class="btn">9</button>
            </div>
            <button id="btn-reset">Resetar</button>
        </div>
    </main>

    <script>
        function fillArray() {
            // console.log("fillArray")
            return [[1, 2, 3], [4, 5, 6], [7, 8, 9]]
        }

        function novaJogada(button, jogador) {
            for (let c = 0; c < 3; c++) {
                for (let i = 0; i < 3; i++) {
                    if (posicoes[c][i] == button) {
                        posicoes[c][i] = jogador
                    }
                }
            }
            console.log(posicoes)
            // return verificarFim()
        }

        function mudarJogador(jogador) {
            // console.log(jogador)
            if (jogador === "X") return "O"

            return "X"
        }

        function verificarFim(jogador) {
            let linha = 0;
            let coluna = 0;
            for (let c = 0; c < 3; c++) {
                for (let i = 0; i < 3; i++) {
                    if (posicoes[c][i] == jogador) {
                        linha++
                    }

                    if (posicoes[i][c] == jogador) {
                        coluna++
                    }
                }
                if (linha === 3 || coluna === 3) return true
                
                linha = 0
                coluna = 0
            }

            if (posicoes[0][0] == jogador && posicoes[1][1] == jogador && posicoes[2][2] == jogador) {
                return true
            } else if (posicoes[0][2] == jogador && posicoes[1][1] == jogador && posicoes[2][0] == jogador) {
                return true
            }
        }

        function resetar() {
            jogador.innerText = "X"
            posicoes = fillArray()
            // console.log(posicoes)
            let num = 1;
            buttons.forEach(button => {
                button.classList.remove("selected")
                button.innerText = num++
            })
        }

        const buttons = document.querySelectorAll(".btn")
        const reset = document.querySelector("#btn-reset")
        const jogador = document.querySelector("#jogador span")
        let posicoes = fillArray()
        // console.log(posicoes[0][0])
        let buttonValue;
        let jogadorValue;
    
        buttons.forEach(button => {
            button.addEventListener("click", () => {
                if (!button.classList.contains("selected")) {
                    buttonValue = button.textContent.toString()
                    jogadorValue = jogador.textContent.toString()
                    novaJogada(buttonValue, jogadorValue)
                    button.classList.add("selected")
                    button.innerText = jogadorValue
                    if (verificarFim(jogadorValue)) {
                        setTimeout(resetar, 1000)
                    }
                    jogador.innerText = mudarJogador(jogadorValue)
                }
            })
        })

        reset.addEventListener("click", resetar);
    </script>
</body>
</html>